{% extends 'base.html' %}
{% load static %}

{% block title %}Онлайн-калькулятор – NovaHaus{% endblock %}
{% block description %}Рассчитайте стоимость ремонта или утепления с помощью нашего онлайн-калькулятора.{% endblock %}
{% block keywords %}калькулятор, стоимость ремонта, утепление, NovaHaus{% endblock %}


{% block head %}
<link rel="stylesheet" href="{% static 'css/calculator.css' %}">
{% endblock %}



{% block content %}
<div class="calculator-container">
    <h1>Онлайн-калькулятор</h1>
    <form id="calculator-form">
        <!-- Выбор типа работ -->
        <div class="form-group">
            <label for="work-type">Тип работ:</label>
            <select id="work-type" name="work-type" required onchange="updateAreaDescription()">
                <option value="apartment">Ремонт квартир</option>
                <option value="house">Ремонт домов</option>
                <option value="office">Ремонт офисов</option>
                <option value="warehouse">Ремонт складов</option>
                <option value="facade">Фасадные работы</option>
                <option value="insulation">Утепление домов</option>
                <option value="demolition">Демонтажные работы</option>
                <option value="cleaning">Уборка после ремонта</option>
            </select>
        </div>

        <!-- Площадь -->
        <div class="form-group">
            <label for="area">Площадь (м²):</label>
            <input type="number" id="area" name="area" required>
            <p id="area-description" class="hint">Введите общую площадь стен, потолков и пола.</p>
        </div>

        <!-- Тип материала (если применимо) -->
        <div class="form-group" id="material-group">
            <label for="material">Тип материала:</label>
            <select id="material" name="material">
                <option value="economy">Эконом</option>
                <option value="standard">Стандарт</option>
                <option value="premium">Премиум</option>
            </select>
        </div>

        <!-- Включение материалов -->
        <div class="form-group">
            <label for="include-materials">Включить материалы:</label>
            <select id="include-materials" name="include-materials">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>

        <!-- Срочность -->
        <div class="form-group">
            <label for="urgency">Срочность:</label>
            <select id="urgency" name="urgency">
                <option value="normal">Обычная</option>
                <option value="fast">Срочная</option>
            </select>
        </div>

        <!-- Дополнительные услуги -->
        <div class="form-group">
            <label>Дополнительные услуги:</label>
            <div>
                <input type="checkbox" id="cleaning" name="cleaning" value="cleaning">
                <label for="cleaning">Уборка после ремонта</label>
            </div>
            <div>
                <input type="checkbox" id="delivery" name="delivery" value="delivery">
                <label for="delivery">Доставка материалов</label>
            </div>
        </div>

        <!-- Кнопка расчета -->
        <button type="button" onclick="calculateCost()" class="btn">Рассчитать</button>

        <!-- Кнопка сохранения расчета -->
        <button type="button" onclick="saveCalculation()" class="btn btn-secondary">Сохранить расчет</button>

        <!-- Кнопка просмотра истории -->
        <button type="button" onclick="showHistory()" class="btn btn-secondary">История расчетов</button>
    </form>

    <!-- Результат -->
    <p id="result" class="result"></p>

    <!-- График -->
    <canvas id="cost-chart" width="400" height="400"></canvas>

    <!-- Модальное окно -->
    <div id="modal" class="modal">
        <div id="modal-content" class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <!-- Контент модального окна будет здесь -->
        </div>
    </div>

    <!-- Блок рекомендаций от ИИ -->
    <div id="ai-recommendations" class="ai-recommendations">
        <h2>Рекомендации от ИИ</h2>
        <p id="ai-recommendation-text"></p>
    </div>

    <!-- Блок обратной связи -->
    <div class="feedback-form">
        <h3>Обратная связь</h3>

        <!-- Поле для имени -->
        <div class="form-group">
            <label for="feedback-name">Ваше имя:</label>
            <input type="text" id="feedback-name" name="feedback-name" placeholder="Введите ваше имя">
        </div>

        <!-- Поле для email -->
        <div class="form-group">
            <label for="feedback-email">Ваш email:</label>
            <input type="email" id="feedback-email" name="feedback-email" placeholder="Введите ваш email">
        </div>

        <!-- Поле для сообщения -->
        <div class="form-group">
            <label for="feedback-message">Ваше сообщение:</label>
            <textarea id="feedback-message" name="feedback-message" placeholder="Введите ваше сообщение"></textarea>
        </div>

        <!-- Кнопка отправки -->
        <button onclick="sendFeedback()" class="btn">Отправить отзыв</button>
    </div>
</div>



<!-- Подключение Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Подключение JavaScript -->
<script src="{% static 'js/visualization.js' %}"></script>
<script src="{% static 'js/calculator.js' %}"></script>
<script src="{% static 'js/modal.js' %}"></script>
<script src="{% static 'js/animations.js' %}"></script>
<script src="{% static 'js/ai-integration.js' %}"></script>
<script src="{% static 'js/history.js' %}"></script>
<script src="{% static 'js/language.js' %}"></script>
<script src="{% static 'js/feedback.js' %}"></script>
<script src="{% static 'js/email-integration.js' %}"></script>
<script src="{% static 'js/chart.js' %}"></script>

<!-- Скрипт для инициализации калькулятора -->
<script>
    // Обновление описания площади при выборе типа работ
    function updateAreaDescription() {
        const workType = document.getElementById('work-type').value;
        const descriptions = {
            apartment: "Введите общую площадь стен, потолков и пола.",
            house: "Введите общую площадь стен, потолков и пола.",
            office: "Введите общую площадь стен, потолков и пола.",
            warehouse: "Введите общую площадь стен, потолков и пола.",
            facade: "Введите площадь фасада.",
            insulation: "Введите площадь утепляемых поверхностей (стены, кровля, фундамент).",
            demolition: "Введите площадь демонтируемых конструкций.",
            cleaning: "Введите общую площадь уборки."
        };
        document.getElementById('area-description').innerText = descriptions[workType];
    }

    // Инициализация при загрузке страницы
    document.addEventListener('DOMContentLoaded', function() {
        updateAreaDescription();
    });
</script>
{% endblock %}